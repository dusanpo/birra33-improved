const baseUrl="https://api.punkapi.com/v2/beers?page=",cardWrapper=document.querySelector(".card-wrapper"),searchByName=document.getElementById("inp-search"),filterFood=document.getElementById("filter-food"),inputBrewedDates=document.querySelectorAll(".date-input"),pageNumber=document.getElementById("pageNumber"),prevPage=document.getElementById("prevPage"),nextPage=document.getElementById("nextPage"),loaderOutput=document.getElementById("loader-output"),ibuFilter=document.getElementById("ibu-filter");let foodPairing="",ABVmin="",ABVmax="",brewedAfter="",brewedBefore="",IBU="",page=1,perPage="&per_page=9";window.addEventListener("load",(()=>{loader(),fetchApi()}));const loader=()=>{loaderOutput.innerHTML='<div class="gif-spinner mx-auto"><img src="images/loader.webp" /></div>'};searchByName.addEventListener("change",(()=>{let e=searchByName.value.trim();loader(),setTimeout((()=>{fetchApi(e)}),500),searchByName.value=""})),filterFood.addEventListener("change",(e=>{switch(e.target.value){case"all":foodPairing="";break;case"chicken":foodPairing="&food=chicken";break;case"cake":foodPairing="&food=cake";break;case"cheese":foodPairing="&food=cheese";break;case"salad":foodPairing="&food=salad"}page=1,loader(),setTimeout((()=>{fetchApi()}),500)})),[sliderOne,sliderTwo].forEach((e=>{e.addEventListener("change",(()=>{let e=sliderOne.value,a=sliderTwo.value;ABVmin="&abv_gt="+e,ABVmax="&abv_lt="+a,page=1,loader(),setTimeout((()=>{fetchApi()}),500)}))})),inputBrewedDates.forEach((e=>{e.addEventListener("change",(e=>{let a=e.target.value,t=`${a.substring(5,7)}-${a.substring(0,4)}`;"after"===e.target.id?brewedAfter="&brewed_after="+t:brewedBefore="&brewed_before="+t,page=1,loader(),setTimeout((()=>{fetchApi()}),500)}))})),ibuFilter.addEventListener("click",(e=>{switch(e.target.value){case 1:IBU="&ibu_gt=24&ibu_lt=45";break;case 2:IBU="&ibu_gt=45&ibu_lt=60";break;case 3:IBU="&ibu_gt=59&ibu_lt=80";break;case 4:IBU="&ibu_gt=0&ibu_lt=25";break;case 5:IBU="&ibu_gt=79";break;case 6:IBU="&ibu_lt=1"}page=1,loader(),setTimeout((()=>{fetchApi()}),500)}));let addToBasket=JSON.parse(localStorage.getItem("data"))||[];const fetchApi=async e=>{let a;a=e?await fetch(`https://api.punkapi.com/v2/beers?beer_name=${e}`):await fetch(baseUrl+page+perPage+foodPairing+ABVmin+ABVmax+brewedBefore+brewedAfter+IBU);let t=await a.json();pageNumber.innerText=page,prevPage.disabled=1===page,t.length<9?nextPage.disabled=!0:nextPage.disabled=!1;let r="";t.map((e=>{const{image_url:a,abv:t,id:d}=e;d>80?nextPage.disabled=!0:(r+=`\n    <div beer-id="${d}" class="col-md-4">\n    <div class="card text-center border-0 cards">\n      <div class="card-body card-main" >\n        <img class="img" src=${a} alt="image"/>\n        <p class="beer-price">$${t}</p>\n        <div class="logo">\n          <i onclick="seeMore(this)" class="fa-solid fa-link fa-3x" beer-id="${d}" data-bs-toggle="modal" data-bs-target="#seeMoreModal"></i>\n        </div>\n      </div>\n      <div class="card-footer card-bottom">\n        <h5>\n          <button onclick="increment(${d}); addToCart(this);" class="w-100">Add to Cart</button>\n        </h5>\n      </div>\n    </div>\n  </div>\n    `,cardWrapper.classList.remove("not-found"))})),0===t.length&&(r="No products were found matching your selection.",cardWrapper.classList.add("not-found")),cardWrapper.innerHTML=r},addToCart=e=>{e.innerText="Added",e.setAttribute("disabled","true")},increment=e=>{let a=e,t=addToBasket.find((e=>e.id===a));void 0===t?addToBasket.push({id:a,item:1}):t.item+=1,calculation(),localStorage.setItem("data",JSON.stringify(addToBasket))};calculation(),prevPage.addEventListener("click",(()=>{page--,fetchApi()})),nextPage.addEventListener("click",(()=>{page++,fetchApi()}));const refreshPage=()=>{loader(),setTimeout((()=>{window.location.reload()}),500)};